<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>STUDIO OFF-BEAT</title>
  <meta name="description" content="STUDIO OFF-BEAT | 기록·공연·이미지" />
  <meta name="color-scheme" content="light" />
  <style>
    /* ------- Reset ------- */
    *,*::before,*::after{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;line-height:1.65;
      -webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;
      background:#f6f6f6;color:#222;
      font-family:"Neue Montreal","NeueMontreal","Inter","Noto Sans KR",-apple-system,system-ui,"Apple SD Gothic Neo",Roboto,Arial,sans-serif;
      letter-spacing:.01em;
    }
    img,svg,video{max-width:100%;display:block}
    .wrap{max-width:1160px;margin-inline:auto;padding:0 18px}

    /* ------- Optional local fonts (put files in /fonts) ------- */
    @font-face{font-family:'Neue Montreal';src:url('fonts/NeueMontreal-Regular.woff2') format('woff2'),url('fonts/NeueMontreal-Regular.woff') format('woff');font-weight:400;font-style:normal;font-display:swap}
    @font-face{font-family:'Neue Montreal';src:url('fonts/NeueMontreal-Medium.woff2') format('woff2'),url('fonts/NeueMontreal-Medium.woff') format('woff');font-weight:500;font-style:normal;font-display:swap}
    @font-face{font-family:'Neue Montreal';src:url('fonts/NeueMontreal-Bold.woff2') format('woff2'),url('fonts/NeueMontreal-Bold.woff') format('woff');font-weight:700;font-style:normal;font-display:swap}

    /* ------- Header ------- */
    header{position:sticky;top:0;z-index:40;background:#f6f6f6;border-bottom:2px solid #000}
    .mast{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
    .brand{letter-spacing:.02em;font-weight:700;color:#000;text-decoration:none;font-size:20px}
    .menu{display:flex;align-items:center;gap:26px}
    .menu a{position:relative;text-decoration:none;color:#222;font-size:14px}
    .menu a::after{content:"";position:absolute;left:0;right:0;bottom:-6px;height:1px;background:#000;transform:scaleX(0);transform-origin:left;transition:transform .25s ease}
    .menu a:hover::after{transform:scaleX(1)}

    /* ------- Camera/Grid overlay ------- */
    :root{ --grid-line: rgba(0,0,0,.22); --grid-bold: rgba(0,0,0,.18); }
    .cam-grid{position:fixed;inset:0;pointer-events:none;z-index:3;
      background-image:
        linear-gradient(to right,
          transparent 0 calc(33.333% - .5px), var(--grid-bold) calc(33.333% - .5px) calc(33.333% + .5px),
          transparent calc(33.333% + .5px) calc(66.666% - .5px), var(--grid-bold) calc(66.666% - .5px) calc(66.666% + .5px),
          transparent calc(66.666% + .5px) 100%),
        linear-gradient(to bottom,
          transparent 0 calc(33.333% - .5px), var(--grid-bold) calc(33.333% - .5px) calc(33.333% + .5px),
          transparent calc(33.333% + .5px) calc(66.666% - .5px), var(--grid-bold) calc(66.666% - .5px) calc(66.666% + .5px),
          transparent calc(66.666% + .5px) 100%),
        linear-gradient(45deg, transparent calc(50% - .5px), var(--grid-line) calc(50% - .5px) calc(50% + .5px), transparent calc(50% + .5px)),
        linear-gradient(-45deg, transparent calc(50% - .5px), var(--grid-line) calc(50% - .5px) calc(50% + .5px), transparent calc(50% + .5px));
      background-size:100% 100%; mix-blend-mode:multiply;
    }

    /* ------- Hero (full screen slider) ------- */
    .hero{position:relative;height:75vh;border-bottom:2px solid #000}
    .hero-slider{position:absolute;inset:0;overflow:hidden}
    .hero-slider .slide-track{display:flex;height:100%;width:100%;transition:transform .6s ease}
    .hero-slider .slide{flex:0 0 100%;height:100%}
    .hero-slider .slide img{width:100%;height:100%;object-fit:cover;filter:grayscale(100%) contrast(1.05)}
    .hero-slider .navbtn{position:absolute;top:50%;transform:translateY(-50%);background:#000;color:#fff;border:none;padding:8px 10px;cursor:pointer;opacity:.85;z-index:5}
    .hero-slider .prev{left:10px}.hero-slider .next{right:10px}
    .hero-slider .dots{position:absolute;left:50%;bottom:14px;transform:translateX(-50%);display:flex;gap:8px;z-index:5}
    .hero-slider .dot{width:8px;height:8px;border:1px solid #000;background:#f6f6f6;cursor:pointer}
    .hero-slider .dot.active{background:#000}

    /* ------- Sections ------- */
    .section{padding:28px 0;border-bottom:1px solid #000}
    .label{display:flex;align-items:center;gap:10px;margin:0 0 14px 0;color:#000;font-weight:700;letter-spacing:.06em}
    .label::after{content:"";height:1px;background:#000;flex:1}
    .with-vlines{position:relative}
    .with-vlines::before{content:"";position:absolute;top:0;bottom:0;left:50%;width:1px;background:#000;opacity:.35;pointer-events:none}
    @media (max-width:799px){.with-vlines::before{display:none}}

    /* ------- Announcement ------- */
    .ann{padding:28px 0;border-bottom:1px solid #000}
    .ann .label{position:relative}
    .ann .label::before{
      content:"";width:46px;height:8px;margin-right:10px;border:1px solid #000;
      background:repeating-linear-gradient(45deg,#000 0 8px,transparent 8px 16px);
    }
    .ann-card{
      border:1px solid #000;background:#fff;padding:16px;
      display:grid;grid-template-columns:1fr;gap:14px;
      background-image:var(--ann-bg, none);
      background-size:cover;background-position:center;
      filter:grayscale(100%);
    }
    .ann-card > *{filter:none}
    @media (min-width:880px){ .ann-card{grid-template-columns:1.2fr .8fr} }
    .ann-title{margin:0;font-size:20px;letter-spacing:-0.01em}
    .ann-meta{display:flex;flex-wrap:wrap;gap:8px;font-size:14px;color:#333}
    .badge{border:1px solid #000;padding:4px 8px}
    .pill{border:1px solid #000;padding:4px 8px;background:#000;color:#fff}
    .ann-actions{display:flex;gap:10px;margin-top:14px}
    .ann-btn{appearance:none;border:1px solid #000;background:#000;color:#fff;padding:8px 12px;font-size:13px;cursor:pointer;text-decoration:none}
    .ann-btn.ghost{background:transparent;color:#000}
    .ann-list{margin:0;padding:0;list-style:none;font-size:14px;background:#fff}
    .ann-list li{display:flex;justify-content:space-between;border-top:1px solid #000;padding:10px 0}

    /* ------- Collections rail ------- */
    .rail{display:flex;gap:18px;overflow:auto;padding:8px 0 12px;scroll-snap-type:x mandatory;border-top:1px solid #000;border-bottom:1px solid #000}
    .tile{flex:0 0 82%;max-width:820px;scroll-snap-align:start;border:1px solid #000;background:#fff}
    @media(min-width:900px){.tile{flex-basis:46%}}
    .tile img{width:100%;aspect-ratio:16/9;object-fit:cover;filter:grayscale(100%);transition:filter .35s ease}
    .tile:hover img{filter:none}
    .tile h3{margin:10px 12px 14px;font-size:16px;letter-spacing:-0.01em}
    .rail-wrap{position:relative}
    .rail-btn{position:absolute;top:50%;transform:translateY(-50%);background:#000;color:#fff;border:1px solid #000;padding:10px 12px;cursor:pointer;z-index:2;opacity:.9}
    .rail-btn.prev{left:-6px}.rail-btn.next{right:-6px}

    /* ------- Works grid ------- */
    .columns{column-count:1;column-gap:22px}
    @media(min-width:800px){.columns{column-count:2}}
    @media(min-width:1080px){.columns{column-count:3}}
    .item{break-inside:avoid;border:1px solid #000;background:#fff;margin:0 0 22px 0}
    .thumb{aspect-ratio:16/10;position:relative;overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;filter:grayscale(100%);transition:filter .35s ease,transform .35s ease}
    .item:hover .thumb img{filter:none;transform:scale(1.02)}
    .thumb-video video{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .25s ease,transform .35s ease;transform:scale(1.02)}
    .item:hover .thumb-video video{opacity:1;transform:scale(1)}
    .item:hover .thumb-video img{opacity:0}
    .meta{padding:12px 14px}
    .title{margin:0 0 6px 0;font-size:18px;color:#000;font-weight:700;letter-spacing:-0.01em}
    .dek{margin:0;color:#333;font-size:14px}

    .actions{display:flex;gap:12px;align-items:center;margin:10px 0 0}
    .btn{appearance:none;border:1px solid #000;background:#000;color:#fff;padding:8px 12px;font-size:13px;cursor:pointer}
    .btn.ghost{background:transparent;color:#000}

    /* ------- Quick Look Modal ------- */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.6);padding:20px;z-index:1000}
    .modal.open{display:flex}
    .modal-card{background:#fff;border:1px solid #000;width:min(920px,92vw)}
    .modal-head{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid #000;padding:10px 12px}
    .modal-title{margin:0;font-weight:700;font-size:16px}
    .modal-close{background:#000;color:#fff;border:1px solid #000;padding:6px 10px;cursor:pointer}
    .modal-body{padding:10px 12px}
    .modal-media{width:100%;max-height:72vh;object-fit:cover;display:block}

    /* ------- Video UI cleanup ------- */
    video::-webkit-media-controls-picture-in-picture-button{display:none}
  </style>
</head>
<body>
  <!-- Camera grid overlay -->
  <div class="cam-grid" aria-hidden="true"></div>

  <header>
    <div class="wrap mast" role="navigation">
      <a class="brand" href="/">STUDIO OFF-BEAT</a>
      <nav class="menu">
        <a href="announcement/">ANNOUNCEMENT</a>
        <a href="collections/">COLLECTIONS</a>
        <a href="works/">WORKS</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" aria-label="Hero">
    <div class="hero-slider">
      <div class="slide-track" id="heroTrack">
        <div class="slide"><img src="banner/banner-1.jpg" alt=""></div>
        <div class="slide"><img src="banner/banner-2.jpg" alt=""></div>
        <div class="slide"><img src="banner/banner-3.jpg" alt=""></div>
      </div>
      <button class="navbtn prev" id="heroPrev" aria-label="Previous">◀</button>
      <button class="navbtn next" id="heroNext" aria-label="Next">▶</button>
      <div class="dots" id="heroDots" aria-hidden="true"></div>
    </div>
  </section>

  <main class="wrap" id="main">
    <!-- Announcement (home-sync가 JSON으로 채움) -->
    <section class="ann with-vlines" id="announcement" style="--ann-bg: none;"
      data-title="OFF-BEAT STAGE #07"
      data-start="2025-03-15T19:30:00+09:00"
      data-end="2025-03-15T21:30:00+09:00"
      data-location="Seochon Studio, Seoul"
      data-desc="로컬 뮤지션 3팀과 함께하는 소규모 라이브. 현장 녹음 및 영상 아카이빙 진행.">
      <h2 class="label">ANNOUNCEMENT</h2>
      <div class="ann-card">
        <div>
          <h3 class="ann-title">OFF-BEAT STAGE #07</h3>
          <div class="ann-meta" style="margin-top:6px">
            <span class="badge">2025.03.15 (Sat) 19:30</span>
            <span class="badge">Seochon Studio</span>
            <span class="pill">Ticket ₩20,000</span>
          </div>
          <p style="margin:12px 0 0 0;color:#333;max-width:60ch">
            로컬 뮤지션 3팀과 함께하는 소규모 라이브. 현장 녹음 및 영상 아카이빙 진행.
          </p>
          <div class="ann-actions">
            <a class="ann-btn" href="#" target="_blank" rel="noopener">예매하기</a>
            <a class="ann-btn ghost" href="#" target="_blank" rel="noopener">자세히 보기</a>
            <button class="ann-btn ghost" id="icsBtn">캘린더 저장(.ics)</button>
          </div>
        </div>
        <div>
          <ul class="ann-list" aria-label="라인업 및 타임테이블">
            <li><span>Door Open</span><span>18:45</span></li>
            <li><span>Act 1 — Folded</span><span>19:30</span></li>
            <li><span>Act 2 — Dune</span><span>20:10</span></li>
            <li><span>Act 3 — Rhea</span><span>20:50</span></li>
            <li><span>After — Talk &amp; Archive</span><span>21:30</span></li>
          </ul>
        </div>
      </div>
    </section>

    <!-- Collections -->
    <section class="section with-vlines" id="collections">
      <h2 class="label">COLLECTIONS</h2>
      <div class="rail-wrap">
        <button class="rail-btn prev" id="railPrev" aria-label="Prev">◀</button>
        <div class="rail" id="rail">
          <!-- home-sync가 featured 컬렉션 4개로 교체 -->
          <article class="tile"><img src="thumbs/thumbs-1.jpg" alt="Stage"><h3>Stage</h3></article>
          <article class="tile"><img src="thumbs/thumbs-2.jpg" alt="Music"><h3>Music</h3></article>
          <article class="tile"><img src="thumbs/thumbs-3.jpg" alt="Seochon Week"><h3>Seochon Week</h3></article>
          <article class="tile"><img src="thumbs/thumbs-4.jpg" alt="Portrait"><h3>Portrait</h3></article>
        </div>
        <button class="rail-btn next" id="railNext" aria-label="Next">▶</button>
      </div>
    </section>

    <!-- Works -->
    <section class="section with-vlines" id="works">
      <div style="display:flex;align-items:center;gap:12px;justify-content:space-between">
        <h2 class="label" style="margin:0">WORKS</h2>
        <div class="actions">
          <button class="btn" id="randomBtn">랜덤 아카이브</button>
          <button class="btn ghost" id="toTopBtn">맨 위로</button>
        </div>
      </div>

      <div class="columns" id="archive">
        <!-- home-sync가 featured 12개로 교체 (기본 값은 폴백) -->
        <a class="item quicklook" href="#work-stage06" data-type="image" data-media="thumbs/stage06.jpg" data-title="OFF-BEAT STAGE #06" data-desc="Live Clip · 2025">
          <div class="thumb"><img src="thumbs/thumbs-1.jpg" alt="OFF-BEAT STAGE #06"></div>
          <div class="meta"><h3 class="title">OFF-BEAT STAGE #06</h3><p class="dek">Live Clip · 2025</p></div>
        </a>
        <a class="item quicklook" href="#work-seochon" data-type="image" data-media="thumbs/seochon-week.jpg" data-title="서촌 브랜드위크 리캡" data-desc="Recap Film · 2025">
          <div class="thumb"><img src="thumbs/thumbs-2.jpg" alt="서촌 브랜드위크 리캡"></div>
          <div class="meta"><h3 class="title">서촌 브랜드위크 리캡</h3><p class="dek">Recap Film · 2025</p></div>
        </a>
        <a class="item quicklook" href="#work-folded" data-type="video" data-media="clips/folded-preview.mp4" data-title="Folded Live Clip" data-desc="Music · 2025">
          <div class="thumb thumb-video">
            <img src="thumbs/thumbs-3.jpg" alt="Folded Live Clip">
            <video muted loop preload="metadata" playsinline disablepictureinpicture controlslist="nodownload noplaybackrate noremoteplayback">
              <source src="clips/folded-preview.mp4" type="video/mp4">
            </video>
          </div>
          <div class="meta"><h3 class="title">Folded Live Clip</h3><p class="dek">Music · 2025</p></div>
        </a>
      </div>
    </section>
  </main>

  <footer>
    <div class="wrap">© <span id="y"></span> STUDIO OFF-BEAT</div>
  </footer>

  <!-- Quick Look Modal -->
  <div class="modal" id="modal" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="modal-card" role="document">
      <div class="modal-head">
        <h3 class="modal-title" id="modalTitle">Title</h3>
        <button class="modal-close" id="modalClose" aria-label="닫기">닫기</button>
      </div>
      <div class="modal-body">
        <img id="modalImg" class="modal-media" alt="" hidden>
        <video id="modalVideo" class="modal-media" controls playsinline hidden disablepictureinpicture controlslist="nodownload noplaybackrate noremoteplayback"></video>
        <p id="modalDesc" style="margin:10px 0 0 0;color:#333"></p>
      </div>
    </div>
  </div>

  <script>
    // Footer year
    document.getElementById('y').textContent = new Date().getFullYear();

    // HERO slider
    const heroTrack=document.getElementById('heroTrack');
    const heroSlides=Array.from(heroTrack.children);
    const heroDotsEl=document.getElementById('heroDots');
    let heroIndex=0;
    function heroPaint(){ heroDotsEl.innerHTML=''; heroSlides.forEach((_,i)=>{ const b=document.createElement('button'); b.className='dot'+(i===heroIndex?' active':''); b.onclick=()=>go(i); heroDotsEl.appendChild(b); }); }
    function go(n){ heroIndex=(n+heroSlides.length)%heroSlides.length; heroTrack.style.transform=`translateX(-${heroIndex*100}%)`; heroPaint(); }
    document.getElementById('heroPrev').onclick=()=>go(heroIndex-1);
    document.getElementById('heroNext').onclick=()=>go(heroIndex+1);
    let heroAuto=setInterval(()=>go(heroIndex+1),6000);
    [heroTrack, document.getElementById('heroPrev'), document.getElementById('heroNext'), heroDotsEl].forEach(el=>{
      el.addEventListener('mouseenter',()=>clearInterval(heroAuto));
      el.addEventListener('mouseleave',()=>heroAuto=setInterval(()=>go(heroIndex+1),6000));
    });
    heroPaint();

    // Collections rail arrows
    const rail=document.getElementById('rail');
    if(rail){
      const step = ()=>Math.floor(rail.clientWidth*0.9);
      document.getElementById('railPrev').addEventListener('click',()=>rail.scrollBy({left:-step(),behavior:'smooth'}));
      document.getElementById('railNext').addEventListener('click',()=>rail.scrollBy({left:step(),behavior:'smooth'}));
    }

    // Quick Look modal (이벤트 위임으로 동적 카드 대응)
    const modal=document.getElementById('modal');
    const modalTitle=document.getElementById('modalTitle');
    const modalDesc=document.getElementById('modalDesc');
    const modalImg=document.getElementById('modalImg');
    const modalVideo=document.getElementById('modalVideo');
    const modalClose=document.getElementById('modalClose');

    function openModal({type,media,title,desc}){
      modalTitle.textContent=title||''; modalDesc.textContent=desc||'';
      modalImg.hidden=true; modalVideo.hidden=true; modalVideo.pause();
      if(type==='video'){ modalVideo.src=media; modalVideo.hidden=false; modalVideo.currentTime=0; modalVideo.play().catch(()=>{}); }
      else { modalImg.src=media; modalImg.alt=title||''; modalImg.hidden=false; }
      modal.classList.add('open');
    }
    function closeModal(){ modal.classList.remove('open'); modalVideo.pause(); }
    modalClose.addEventListener('click',closeModal);
    modal.addEventListener('click',e=>{ if(e.target===modal) closeModal(); });
    document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeModal(); });

    // ★ 위임: home-sync가 주입한 .quicklook에도 동작
    document.addEventListener('click',(e)=>{
      const card = e.target.closest('.quicklook');
      if(!card) return;
      if(!document.getElementById('archive').contains(card)) return;
      e.preventDefault();
      openModal({
        type:card.dataset.type,
        media:card.dataset.media,
        title:card.dataset.title,
        desc:card.dataset.desc
      });
    });

    // Hover video preview
    document.addEventListener('mouseenter', (e)=>{
      const v = e.target.closest('.thumb-video')?.querySelector('video');
      if(v){ v.currentTime=0; v.play().catch(()=>{}); }
    }, true);
    document.addEventListener('mouseleave', (e)=>{
      const v = e.target.closest('.thumb-video')?.querySelector('video');
      if(v){ v.pause(); }
    }, true);

    // Random archive
    const randomBtn=document.getElementById('randomBtn');
    if(randomBtn){
      randomBtn.addEventListener('click',()=>{
        const cards=Array.from(document.querySelectorAll('#archive .item'));
        if(!cards.length) return;
        const pick=cards[Math.floor(Math.random()*cards.length)];
        pick.scrollIntoView({behavior:'smooth',block:'center'});
      });
    }

    // Top
    document.getElementById('toTopBtn')?.addEventListener('click',()=>window.scrollTo({top:0,behavior:'smooth'}));
  </script>

  <!-- 홈 데이터 자동 주입 -->
  <script type="module" src="assets/js/home-sync.js"></script>
</body>
</html>